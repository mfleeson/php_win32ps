# Generated by configure.js
PHP_SRC_DIR =D:\Mark\Documents\GitHub\new_php_win32ps\win32ps
PHP_CL=cl.exe 

PHP_COMPILER_SHORT=vs16 

PHP_ARCHITECTURE=x64 

LINK=link.exe 

NMAKE=nmake.exe 

MAKE_LIB=lib.exe 

BISON=bison.exe 

SED=sed.exe 

RE2C=re2c.exe 

ZIP=zip.exe 

LEMON=lemon.exe 

7ZA=7za.exe 

MC=C:\Program Files (x86)\Windows Kits\10\bin\10.0.22621.0\x64\mc.exe 

MT=C:\Program Files (x86)\Windows Kits\10\bin\10.0.22621.0\x64\mt.exe 

PHP_PREFIX=C:\php 

BASE_INCLUDES=/I c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64/include /I c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64/include/main /I c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64/include/Zend /I c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64/include/TSRM /I c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64/include/ext 

CFLAGS_PHP_OBJ=$(CFLAGS_PHP) $(STATIC_EXT_CFLAGS) 

DLL_LDFLAGS=/dll 

PHP_LDFLAGS=$(DLL_LDFLAGS) /nodefaultlib:libcmt 

LIBS=kernel32.lib ole32.lib user32.lib advapi32.lib shell32.lib ws2_32.lib Dnsapi.lib psapi.lib bcrypt.lib 

ZTS=1 

PHP_ZTS_ARCHIVE_POSTFIX= 

BUILD_DIR=D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\x64\Release_TS 

PHPDLL=php8ts.dll 

PHPLIB=php8ts.lib 

PHP_BUILD=D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\no 

CFLAGS=/nologo $(BASE_INCLUDES) /D _WINDOWS /D WINDOWS=1 /D ZEND_WIN32=1 /D PHP_WIN32=1 /D WIN32 /D _MBCS /D _USE_MATH_DEFINES /FD /wd4996 /Qspectre /guard:cf /Zc:inline /Zc:__cplusplus /d2FuncCache1 /Zc:wchar_t /MP /LD /MD /Ox /D NDebug /D NDEBUG /GF /D ZEND_DEBUG=0 /D ZTS=1 /I "D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\no\include" 

LDFLAGS=/nologo /GUARD:CF /d2:-AllowCompatibleILVersions /libpath:"\"D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\no\lib\"" 

ARFLAGS=/libpath:"\"D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\no\lib\"" 

SNAPSHOT_TEMPLATE=no 

PHP_DIR=c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64 

PHP_SIMD_SCALE=SSE2 

LIBS_WIN32PS=psapi.lib 

CFLAGS_PHP=/D _USRDLL /D PHP7DLLTS_EXPORTS /D PHP_EXPORTS /D LIBZEND_EXPORTS /D TSRM_EXPORTS /D SAPI_EXPORTS /D WINVER=0x0601 /D COMPILE_DL_WIN32PS 

CFLAGS_BD_=/Fp$(BUILD_DIR)\\ /FR$(BUILD_DIR)\\ /Fd$(BUILD_DIR)\\ 

WIN32PS_GLOBAL_OBJS=$(BUILD_DIR)\\win32ps.obj 

WIN32PS_GLOBAL_OBJS_RESP=@"D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\x64\Release_TS\resp\WIN32PS_GLOBAL_OBJS.txt" 

EXT_TARGETS=php_win32ps.dll 

CFLAGS_WIN32PS_OBJ=$(CFLAGS_WIN32PS) 

CFLAGS_WIN32PS=/DHAVE_PSAPI_H=1 /D ZEND_COMPILE_DL_EXT=1 /D COMPILE_DL_WIN32PS /D WIN32PS_EXPORTS=1 

BUILD_DIRS_SUB=D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\x64\Release_TS 

PHP_TEST_INI_PATH=""

CC="$(PHP_CL)"
LD="$(LINK)"
MC="$(MC)"
MT="$(MT)"

PHPSDK_DIR=$(PHP_DIR)
PHPLIB=$(PHPSDK_DIR)\lib\$(PHPLIB)
LDFLAGS=$(LDFLAGS) /libpath:"$(PHPSDK_DIR)\lib\;$(PHPSDK_DIR)"
BUILD_DIR_DEV=$(PHPSDK_DIR)

!if "$(DEBUGGER)" == "1"
DEBUGGER_CMD=devenv
DEBUGGER_ARGS=/debugexe
!else
DEBUGGER_CMD=
DEBUGGER_ARGS=
!endif

all: $(EXT_TARGETS) $(PECL_TARGETS)

build_dirs: $(BUILD_DIR) $(BUILD_DIRS_SUB)

clean-pecl:
	@echo Cleaning PECL targets only
	-rd /s /q $(BUILD_DIR)\pecl

clean-all:
	@echo Cleaning standard build dirs
	cd $(BUILD_DIR)
	@for %D in (_x $(BUILD_DIRS_SUB)) do @if exist %D @rd /s /q %D
	-@del /f /q $(BUILD_DIR)\*.res $(BUILD_DIR)\*.manifest $(BUILD_DIR)\*.lib $(BUILD_DIR)\*.ilk $(BUILD_DIR)\*.pdb $(BUILD_DIR)\*.exp $(PHPDEF) $(BUILD_DIR)\*.rc $(BUILD_DIR)\*.dbg $(BUILD_DIR)\*.bin $(BUILD_DIR)\php*.dll $(BUILD_DIR)\php*.exe > NUL

clean: clean-pecl
	@echo Cleaning distribution build dirs
	cd $(BUILD_DIR)
	@for %D in (_x $(BUILD_DIRS_SUB)) do @if exist %D @del /F /Q %D\*.* > NUL
	-@del /F /Q $(BUILD_DIR)\*.res $(BUILD_DIR)\*.lib $(BUILD_DIR)\*.ilk $(BUILD_DIR)\*.pdb $(BUILD_DIR)\*.exp $(PHPDEF) $(BUILD_DIR)\php-$(PHP_VERSION_STRING)-Win32.zip $(BUILD_DIR)\pecl-$(PHP_VERSION_STRING)-Win32.zip > NUL

!if "$(EXT_TARGETS)" == ""
_EXTENSION_DLL=$(PECL_TARGETS)
!else
_EXTENSION_DLL=$(EXT_TARGETS)
!endif

!if $(PHP_TEST_INI_PATH) == ""
test: set-tmp-env
	$(DEBUGGER_CMD) $(DEBUGGER_ARGS) "$(PHP_PREFIX)\php.exe" -d open_basedir= -d output_buffering=0 run-tests.php -p "$(PHP_PREFIX)\php.exe" -d extension=$(BUILD_DIR)\$(_EXTENSION_DLL) $(TESTS)

run: set-tmp-env
	$(DEBUGGER_CMD) $(DEBUGGER_ARGS) "$(PHP_PREFIX)\php.exe" -n -d extension=$(BUILD_DIR)\\$(_EXTENSION_DLL) $(ARGS)
!else
test: set-tmp-env
	$(DEBUGGER_CMD) $(DEBUGGER_ARGS) "$(PHP_PREFIX)\php.exe" -n -d open_basedir= -d output_buffering=0 -d memory_limit=-1 run-tests.php -p "$(PHP_PREFIX)\php.exe" -n -c $(PHP_TEST_INI_PATH) $(TESTS)

run: set-tmp-env
	$(DEBUGGER_CMD) $(DEBUGGER_ARGS) "$(PHP_PREFIX)\php.exe" -n -c $(PHP_TEST_INI_PATH) $(ARGS)
!endif

!if $(MT) == ""
_VC_MANIFEST_EMBED_EXE=
_VC_MANIFEST_EMBED_DLL=
!else
_VC_MANIFEST_EMBED_EXE= if exist $@.manifest $(MT) -nologo -manifest $@.manifest -outputresource:$@;1
_VC_MANIFEST_EMBED_DLL= if exist $@.manifest $(MT) -nologo -manifest $@.manifest -outputresource:$@;2
!endif

install: build-headers  build-bins
build-headers:
	@if not exist $(BUILD_DIR_DEV)\include mkdir $(BUILD_DIR_DEV)\include >nul
	@for %D in ($(INSTALL_HEADERS_DIR)) do @if not exist $(BUILD_DIR_DEV)\include\%D mkdir $(BUILD_DIR_DEV)\include\%D >nul
	@for %D in ($(INSTALL_HEADERS_DIR)) do @copy %D*.h $(BUILD_DIR_DEV)\include\%D /y >nul

build-bins:
	@copy $(BUILD_DIR)\php_win32ps.lib $(BUILD_DIR_DEV)\lib
  @if not exist $(PHP_PREFIX) mkdir $(PHP_PREFIX) >nul
  @if not exist $(PHP_PREFIX)\ext mkdir $(PHP_PREFIX)\ext >nul
	@copy $(BUILD_DIR)\php_win32ps.dll $(PHP_PREFIX)\ext

set-tmp-env:
	@set PATH=$(PHP_BUILD)\bin;$(PATH)


dump-tmp-env: set-tmp-env
	@set



# objects for EXT win32ps

$(BUILD_DIR)\\win32ps.obj: D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\win32ps.c
	$(CC) $(CFLAGS_WIN32PS_OBJ) $(CFLAGS) /Fo$(BUILD_DIR)\\ $(CFLAGS_BD_) /c D:\Mark\Documents\GitHub\new_php_win32ps\win32ps\win32ps.c 

$(BUILD_DIR)\php_win32ps.dll.res: $(PHP_DIR)\build\template.rc
	$(RC) /nologo  $(BASE_INCLUDES) /I $(PHP_DIR)/include /n /fo $(BUILD_DIR)\php_win32ps.dll.res /d FILE_DESCRIPTION="\"win32ps\"" /d FILE_NAME="\"php_win32ps.dll\"" /d URL="\"https://www.php.net\"" /d INTERNAL_NAME="\"WIN32PS extension\"" /d THANKS_GUYS="\"Thanks to Michael Wallner\"" $(PHP_DIR)\build\template.rc

$(BUILD_DIR)\php_win32ps.dll.manifest: c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64\build\default.manifest
	@copy c:\build-cache\php-8.2.26-devel-vs16-x64\php-8.2.26-devel-vs16-x64\build\default.manifest $(BUILD_DIR)\php_win32ps.dll.manifest >nul
$(BUILD_DIR)\php_win32ps.lib: $(BUILD_DIR)\php_win32ps.dll

$(BUILD_DIR)\php_win32ps.dll: $(DEPS_WIN32PS) $(WIN32PS_GLOBAL_OBJS) $(PHPLIB) $(BUILD_DIR)\php_win32ps.dll.res $(BUILD_DIR)\php_win32ps.dll.manifest
	"$(LINK)" $(WIN32PS_GLOBAL_OBJS_RESP) $(PHPLIB) $(LIBS_WIN32PS) $(LIBS) $(BUILD_DIR)\php_win32ps.dll.res /out:$(BUILD_DIR)\php_win32ps.dll $(DLL_LDFLAGS) $(LDFLAGS) $(LDFLAGS_WIN32PS)
	-@$(_VC_MANIFEST_EMBED_DLL)

php_win32ps.dll: $(BUILD_DIR)\php_win32ps.dll
	@echo EXT win32ps build complete



